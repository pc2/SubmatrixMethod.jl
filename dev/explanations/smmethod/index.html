<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Submatrix Method · SubmatrixMethod.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="SubmatrixMethod.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SubmatrixMethod.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SubmatrixMethod</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/matrix_inv/">Matrix Inversion</a></li><li><a class="tocitem" href="../../examples/matrix_inv_distributed/">Matrix Inversion (Distributed)</a></li><li><a class="tocitem" href="../../examples/matrix_inv_mpi/">Matrix Inversion (MPI)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Submatrix Method</a><ul class="internal"><li><a class="tocitem" href="#Strategy"><span>Strategy</span></a></li><li><a class="tocitem" href="#Complexity-(Single-Threaded)"><span>Complexity (Single-Threaded)</span></a></li><li><a class="tocitem" href="#Parallelization"><span>Parallelization</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">References</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../refs/api/">API</a></li><li><a class="tocitem" href="../../refs/lc/">Launch Configurations</a></li><li><a class="tocitem" href="../../refs/submatrix_core/">Core</a></li><li><a class="tocitem" href="../../refs/io/">IO</a></li><li><a class="tocitem" href="../../refs/utility/">Utility</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Development Docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../devel/guide/">Contribution Guide</a></li><li><a class="tocitem" href="../../devel/benchmarking/">Benchmarking</a></li><li><a class="tocitem" href="../../devel/testing/">Testing</a></li><li><a class="tocitem" href="../../devel/analysis/">Analysis</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Explanations</a></li><li class="is-active"><a href>Submatrix Method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Submatrix Method</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://git.uni-paderborn.de/pc2/julia/submatrixmethod.jl/blob/master/docs/src/explanations/smmethod.md#" title="Edit source"><span class="docs-icon fa"></span><span class="docs-label is-hidden-touch">Edit source</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="submatrixmethod"><a class="docs-heading-anchor" href="#submatrixmethod">Submatrix Method</a><a id="submatrixmethod-1"></a><a class="docs-heading-anchor-permalink" href="#submatrixmethod" title="Permalink"></a></h1><figure>
    <img src="../../assets/imgs/smmethod.svg" width="80%"/>
    <figcaption>Fig.1 – Illustration of the submatrix method.</figcaption>
</figure><h2 id="Strategy"><a class="docs-heading-anchor" href="#Strategy">Strategy</a><a id="Strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Strategy" title="Permalink"></a></h2><p>We consider a sparse, symmetric, <span>$n \times n$</span>, input matrix <span>$A$</span> for which we want to compute the matrix function <span>$f(A)$</span>. The strategy of the submatrix method is simple: instead of computing <span>$f(A)$</span> directly, we</p><ul><li>decompose <span>$A$</span> into <span>$n$</span> submatrices <span>$S_i$</span>,</li><li>apply <span>$f$</span> to each submatrix,</li><li>and approximate <span>$f(A)$</span> from the submatrix results <span>$f(S_i)$</span> (see Fig. 1).</li></ul><p>Specifically, a submatrix <span>$S_i$</span> is associated with the <span>$i$</span>-th column of <span>$A$</span> and is constructed as follows. First, we find the row indices <span>$\gamma$</span> of all the non-zero elements in column <span>$i$</span>. Next, we extract those elements from <span>$A$</span> that correspond to all pairs that we can form from <span>$\gamma$</span> and &quot;glue them together&quot; to build the submatrix <span>$S_i$</span>. Note that while <span>$S_i$</span> is associated with column <span>$i$</span>, in particular its non-zero entries, it still contains elements from other columns as well.</p><p>Once we have the submatrices <span>$S_i$</span>, we compute <span>$f(S_i)$</span> for each of them. Afterwards, the desired result <span>$f(A)$</span> is approximated by the result matrix <span>$R$</span> which has the same sparsity pattern as <span>$A$</span> - that is the count and position of non-zero entries is preserved - but whose values in a column <span>$i$</span> are given by the corresponding column <span>$\tilde{i}$</span> of <span>$f(S_i)$</span> (see Fig. 1). Hence, each submatrix computation produces one column of the result matrix.</p><h2 id="Complexity-(Single-Threaded)"><a class="docs-heading-anchor" href="#Complexity-(Single-Threaded)">Complexity (Single-Threaded)</a><a id="Complexity-(Single-Threaded)-1"></a><a class="docs-heading-anchor-permalink" href="#Complexity-(Single-Threaded)" title="Permalink"></a></h2><p>(Note that we will neglect the runtime cost of the assembly of the submatrices and the final result which is expected to be irrelevant in the asymptotic limit.)</p><p>Let <span>$I(n)$</span> be the computational complexity associated with the application of the given matrix function <span>$f$</span> and let <span>$d$</span> be the density of the input matrix <span>$A$</span>. On average, submatrices are then of size <span>$m \times m$</span> where with <span>$m = d \cdot n$</span>. Given that the density <span>$d$</span> is small enough, one has</p><p class="math-container">\[\begin{aligned}
S(n,d) = n \cdot I(d \cdot n) &lt; I(n)
\end{aligned}\]</p><p>in which case the single-threaded submatrtix method computation <span>$S(n,d)$</span> is faster than applying <span>$f$</span> directly.</p><h3 id="Asymptotic-scaling"><a class="docs-heading-anchor" href="#Asymptotic-scaling">Asymptotic scaling</a><a id="Asymptotic-scaling-1"></a><a class="docs-heading-anchor-permalink" href="#Asymptotic-scaling" title="Permalink"></a></h3><p>Let&#39;s assume that <span>$I(n) = \Omega(n^p)$</span>, i.e. that the complexity of computing <span>$f(A)$</span> is at least <span>$n^p$</span>. In this case, the relation above simplifies to <span>$d &lt; n^{-1/p}$</span>. This implies that if the density <span>$d$</span> decreases at a rate faster than <span>$n^{-1/p}$</span> than <span>$S(n,d) &lt; I(n)$</span>, i.e. the approximate submatrix method computation is computationally cheaper than the regular application of <span>$f$</span>.</p><h2 id="Parallelization"><a class="docs-heading-anchor" href="#Parallelization">Parallelization</a><a id="Parallelization-1"></a><a class="docs-heading-anchor-permalink" href="#Parallelization" title="Permalink"></a></h2><p><em>The</em> crucial feature of the submatrix method is that the individual submatrix computations f(S_i) are entirely independent from each other. This paves the way for massive parallelization where submatrices are processed by different threads (multithreading) or nodes (distributed computing). Data communication is only necessary for distributing the relevant matrix elements at the start of the procedure and collecting the result in the end. Assuming that we can distribute each submatrix computation to a separate node, the overall execution time can be held constant.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><blockquote><p><a href="https://dl.acm.org/doi/abs/10.1145/3218176.3218231?casa_token=eF5IVn4mss4AAAAA:wcpAnDcYvef-rx-ixREp6uIl_TBaYfnIv64-bcLAl4Am3fnJvzMw9GQd4h2_WEojEiKDG1CcVgN3MA"><em>A Massively Parallel Algorithm for the Approximate Calculation of Inverse p-th Roots of Large Sparse Matrices</em></a>   Michael Lass, Stephan Mohr, Hendrik Wiebeler, Thomas D. Kühne, Christian Plessl   GitHub repository: <a href="https://github.com/pc2/SubmatrixMethod">https://github.com/pc2/SubmatrixMethod</a></p></blockquote><blockquote><p><a href="https://ieeexplore.ieee.org/document/9355245"><em>A Submatrix-Based Method for Approximate Matrix Function Evaluation in the Quantum Chemistry Code CP2K</em></a>   Michael Lass, Robert Schade, Thomas D. Kühne, Christian Plessl   arXiv: https://arxiv.org/abs/2004.10811</p></blockquote></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../examples/matrix_inv_mpi/">« Matrix Inversion (MPI)</a><a class="docs-footer-nextpage" href="../../refs/api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Saturday 29 January 2022 13:11">Saturday 29 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
